"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[7292],{47992:(e,t,a)=>{a.d(t,{G:()=>u});var s=a(9950),n=a(95491),l=a.n(n),r=a(99674),i=a(90650),d=a(44414);const u=e=>{let{fetchOptions:t,debounceTimeout:a=400,onClear:n,...u}=e;const[o,c]=(0,s.useState)(!1),[m,p]=(0,s.useState)([]),h=(0,s.useMemo)((()=>l()((e=>{p([]),c(!0),t(e).then((e=>{p(e),c(!1)}))}),a)),[t,a]);return(0,d.jsx)(r.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),n&&n()},notFoundContent:o?(0,d.jsx)(i.A,{size:"small"}):"no results",...u,options:m,onFocus:()=>{h("")}})}},7292:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var s=a(9950),n=a(28429),l=a(49348),r=a(59233),i=a(23263),d=a(59051),u=a.n(d),o=a(91854),c=a(74623),m=a(35765),p=a(73439),h=a(70030),v=a(62466),f=a(81446),x=a(86954),A=a(44414);function Y(){const{t:e}=(0,h.B)(),{activeMenu:t}=(0,o.d4)((e=>e.menu),o.bN),a=(0,o.wA)(),{id:d}=(0,n.g)(),[Y]=r.A.useForm(),j=(0,n.Zp)(),[b,g]=(0,s.useState)(!1);(0,s.useEffect)((()=>()=>{const e=Y.getFieldsValue(!0),s=JSON.stringify(e.start),n=JSON.stringify(e.end),l={...e,start:s,end:n};a((0,c.Ok)({activeMenu:t,data:l}))}),[]),(0,s.useEffect)((()=>{t.refetch&&(g(!0),m.A.getById(d).then((e=>{let{data:s}=e;const n={price:null===s||void 0===s?void 0:s.price,type:null===s||void 0===s?void 0:s.type,products:null===s||void 0===s?void 0:s.products.map((e=>{var t;return{label:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===e||void 0===e?void 0:e.id}})),start:u()(null===s||void 0===s?void 0:s.start,"YYYY-MM-DD"),end:u()(null===s||void 0===s?void 0:s.end,"YYYY-MM-DD"),image:[(0,v.A)(null===s||void 0===s?void 0:s.img)]};Y.setFieldsValue(n),a((0,c.Ok)({activeMenu:t,data:{...n,start:null===s||void 0===s?void 0:s.start,end:null===s||void 0===s?void 0:s.end}}))})).finally((()=>{g(!1),a((0,c.km)(t))})))}),[t.refetch]);return(0,A.jsx)(i.A,{title:e("edit.discount"),className:"h-100",children:b?(0,A.jsx)(f.A,{}):(0,A.jsx)(x.A,{form:Y,handleSubmit:(s,n)=>{var r;if(u()(s.start).format("YYYY-MM-DD")>u()(s.end).format("YYYY-MM-DD"))return l.oR.error(e("start.date.must.be.before.end.date"));const i={price:s.price,type:s.type,products:s.products.map((e=>e.value)),start:s.start?u()(s.start).format("YYYY-MM-DD"):void 0,end:s.end?u()(s.end).format("YYYY-MM-DD"):void 0,images:[null===(r=n[0])||void 0===r?void 0:r.name]},h="seller/discounts";return m.A.update(d,i).then((()=>{l.oR.success(e("successfully.updated")),(0,o.vA)((()=>{a((0,c.EK)({...t,nextUrl:h})),a((0,p.X)({}))})),j("/".concat(h))}))}})})}},86954:(e,t,a)=>{a.d(t,{A:()=>Y});var s=a(9950),n=a(59233),l=a(87094),r=a(41988),i=a(99674),d=a(56952),u=a(5713),o=a(48538),c=a(59051),m=a.n(c),p=a(47992),h=a(48970),v=a(70030),f=a(91854),x=a(67231),A=a(44414);function Y(e){var t,a;let{form:c,handleSubmit:Y}=e;const{t:j}=(0,v.B)(),{activeMenu:b}=(0,f.d4)((e=>e.menu),f.bN),{myShop:g}=(0,f.d4)((e=>e.myShop),f.bN),[y,M]=(0,s.useState)(!1),[D,S]=(0,s.useState)(null!==(t=b.data)&&void 0!==t&&t.image?null===(a=b.data)||void 0===a?void 0:a.image:[]);return(0,A.jsxs)(n.A,{name:"discount-form",layout:"vertical",onFinish:e=>{M(!0),Y(e,D).finally((()=>M(!1)))},form:c,initialValues:{...(()=>{var e;const t=b.data;if(null===(e=b.data)||void 0===e||!e.start)return t;const a=b.data.start,s=b.data.end;return{...t,start:m()(a,"YYYY-MM-DD"),end:m()(s,"YYYY-MM-DD")}})()},className:"d-flex flex-column h-100",children:[(0,A.jsxs)(l.A,{gutter:12,children:[(0,A.jsx)(r.A,{span:12,children:(0,A.jsx)(n.A.Item,{label:j("type"),name:"type",rules:[{required:!0,message:j("required")}],children:(0,A.jsxs)(i.A,{children:[(0,A.jsx)(i.A.Option,{value:"fix",children:j("fix")}),(0,A.jsx)(i.A.Option,{value:"percent",children:j("percent")})]})})}),(0,A.jsx)(r.A,{span:12,children:(0,A.jsx)(n.A.Item,{label:j("price"),name:"price",rules:[{required:!0,message:j("required")}],children:(0,A.jsx)(d.A,{min:0,className:"w-100"})})}),(0,A.jsx)(r.A,{span:12,children:(0,A.jsx)(n.A.Item,{label:j("start.date"),name:"start",rules:[{required:!0,message:j("required")}],children:(0,A.jsx)(u.A,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,A.jsx)(r.A,{span:12,children:(0,A.jsx)(n.A.Item,{label:j("end.date"),name:"end",rules:[{required:!0,message:j("required")}],children:(0,A.jsx)(u.A,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,A.jsx)(r.A,{span:24,children:(0,A.jsx)(n.A.Item,{label:j("products"),name:"products",rules:[{required:!0,message:j("required")}],children:(0,A.jsx)(p.G,{fetchOptions:async function(e){const t={search:e,shop_id:g.id,status:"published",active:1,rest:1};return x.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))}))},mode:"multiple"})})}),(0,A.jsx)(r.A,{span:24,children:(0,A.jsx)(n.A.Item,{label:j("image"),name:"images",rules:[{required:!D.length,message:j("required")}],children:(0,A.jsx)(h.A,{type:"discounts",imageList:D,setImageList:S,form:c,multiple:!1,name:"image"})})})]}),(0,A.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,A.jsx)("div",{className:"pb-5",children:(0,A.jsx)(o.A,{type:"primary",htmlType:"submit",loading:y,children:j("submit")})})})]})}}}]);