"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[7376],{7376:(t,e,i)=>{i.r(e),i.d(e,{default:()=>b});var a=i(9950),n=i(28429),l=i(49348),s=i(86366),o=i(59233),c=i(23263),r=i(90650),d=i(63620),u=i(91854),g=i(74623),m=i(70030),v=i(71999),p=i(64986),h=i(69292),f=i(44414);const{Step:_}=s.A,b=()=>{var t,e,i;const{t:b}=(0,m.B)(),{activeMenu:y}=(0,u.d4)((t=>t.menu),u.bN),{id:j}=(0,n.g)(),k=(0,u.wA)(),{defaultLang:x,languages:A}=(0,u.d4)((t=>t.formLang),u.bN),[N,S]=(0,a.useState)((null===(t=y.data)||void 0===t?void 0:t.step)||0),[w,F]=(0,a.useState)(null!==(e=y.data)&&void 0!==e&&e.image?[null===(i=y.data)||void 0===i?void 0:i.image]:[]),C=()=>{S(N+1)},E=()=>{S(N-1)},[O]=o.A.useForm(),M=(0,n.Zp)(),[V,q]=(0,a.useState)(!1),[B,I]=(0,a.useState)(!1);(0,a.useEffect)((()=>()=>{const t=O.getFieldsValue(!0);k((0,g.Ok)({activeMenu:y,data:t}))}),[]);return(0,a.useEffect)((()=>{y.refetch&&(t=>{q(!0),h.A.getById(t).then((t=>{var e;let i=t.data;var a;console.log("recept",i),O.setFieldsValue({...i,active_time:Number(i.active_time),total_time:Number(i.total_time),title:{[x]:i.translation.title},description:{[x]:i.translation.description},instruction:Object.assign({},...i.instructions.map((t=>({[t.locale]:t.title})))),ingredient:Object.assign({},...i.ingredients.map((t=>({[t.locale]:t.title})))),nutrition:null===(e=i.nutritions)||void 0===e?void 0:e.map((t=>({percentage:Number(null===t||void 0===t?void 0:t.percentage),weight:Number(null===t||void 0===t?void 0:t.weight),...Object.assign({},...t.translations.flatMap((t=>({[t.locale]:t.title}))))}))),category_id:{value:i.category.id,label:i.category.translation.title},stocks:i.stocks.map((t=>({stock_id:{value:t.id,label:t.product.translation.title},...t})))}),F([(a=i.img,{name:a,url:d.sE+a})])})).finally((()=>{q(!1),k((0,g.km)(y))}))})(j)}),[y.refetch]),(0,f.jsx)(c.A,{title:b("edit.recepe"),extra:(0,f.jsx)(v.A,{}),children:V?(0,f.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,f.jsx)(r.A,{size:"large",className:"py-5"})}):(0,f.jsxs)(o.A,{layout:"vertical",onFinish:t=>{var e;O.validateFields();const i={...t,total_time:t.total_time.toString(),active_time:t.active_time.toString(),category_id:t.category_id.value,images:null===w||void 0===w?void 0:w.map((t=>t.name)),stocks:t.stocks.map((t=>({min_quantity:t.min_quantity,stock_id:t.stock_id.value}))),nutrition:null===(e=t.nutrition)||void 0===e?void 0:e.map((t=>{var e;return{...t,percentage:null===t||void 0===t||null===(e=t.percentage)||void 0===e?void 0:e.toString(),weight:t.weight.toString()}}))};I(!0);const a="seller/recept";h.A.update(j,i).then((()=>{l.oR.success(b("successfully.updated")),M("/".concat(a)),k((0,g.EK)({...y,nextUrl:a}))})).finally((()=>I(!1)))},form:O,initialValues:{active:!0,...y.data},children:[(0,f.jsx)(s.A,{current:N,children:p.C.map((t=>(0,f.jsx)(_,{title:b(t.title)},t.title)))}),p.C.map((t=>{const e=t.content;return(0,f.jsx)("div",{className:"steps-content ".concat(t.step!==N+1&&"hidden"),children:(0,f.jsx)(e,{next:C,prev:E,loading:B,image:w,setImage:F})},t.title)}))]})})}}}]);