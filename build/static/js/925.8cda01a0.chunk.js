"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[925],{60925:(t,e,a)=>{a.r(e),a.d(e,{default:()=>b});var i=a(9950),l=a(28429),n=a(49348),s=a(86366),o=a(59233),r=a(23263),c=a(90650),d=a(63620),u=a(91854),g=a(74623),v=a(70030),p=a(71999),h=a(96210),m=a(5742),f=a(44414);const{Step:_}=s.A,b=()=>{var t,e,a;const{t:b}=(0,v.B)(),{activeMenu:k}=(0,u.d4)((t=>t.menu),u.bN),{id:y}=(0,l.g)(),j=(0,u.wA)(),{defaultLang:x}=(0,u.d4)((t=>t.formLang),u.bN),[S,A]=(0,i.useState)((null===(t=k.data)||void 0===t?void 0:t.step)||0),w=t=>({name:t,url:d.sE+t}),[F,N]=(0,i.useState)(null!==(e=k.data)&&void 0!==e&&e.galleries[0]?[w(k.data.galleries[0].path)]:[]),[C,E]=(0,i.useState)(null!==(a=k.data)&&void 0!==a&&a.galleries[1]?[w(k.data.galleries[1].path)]:[]),O=()=>{A(S+1)},B=()=>{A(S-1)},[M]=o.A.useForm(),V=(0,l.Zp)(),[q,I]=(0,i.useState)(!1),[L,z]=(0,i.useState)(!1);(0,i.useEffect)((()=>()=>{const t=M.getFieldsValue(!0);j((0,g.Ok)({activeMenu:k,data:t}))}),[]);const K=[...F,...C];return(0,i.useEffect)((()=>{k.refetch&&(t=>{I(!0),m.A.getById(t).then((t=>{var e,a,i;let l=t.data;M.setFieldsValue({...l,title:{[x]:l.translation.title},description:{[x]:l.translation.description},instruction:Object.assign({},...l.instructions.map((t=>({[t.locale]:t.title})))),ingredient:Object.assign({},...l.ingredients.map((t=>({[t.locale]:t.title})))),nutrition:null===(e=l.nutritions)||void 0===e?void 0:e.map((t=>{var e;return{percentage:null===t||void 0===t||null===(e=t.percentage)||void 0===e?void 0:e.toString(),weight:t.weight,...Object.assign({},...t.translations.flatMap((t=>({[t.locale]:t.title}))))}})),category_id:{value:l.category.id,label:null===(a=l.category.translation)||void 0===a?void 0:a.title},shop_id:{value:l.shop.id,label:null===(i=l.shop.translation)||void 0===i?void 0:i.title},stocks:l.stocks.map((t=>{var e,a;return{stock_id:{value:t.id,label:null===t||void 0===t||null===(e=t.product)||void 0===e||null===(a=e.translation)||void 0===a?void 0:a.title},...t}}))}),N([w(l.galleries[0].path)]),E([w(l.galleries[1].path)])})).finally((()=>{I(!1),j((0,g.km)(k))}))})(y)}),[k.refetch]),(0,f.jsx)(r.A,{title:b("edit.recepe"),extra:(0,f.jsx)(p.A,{}),children:q?(0,f.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,f.jsx)(c.A,{size:"large",className:"py-5"})}):(0,f.jsxs)(o.A,{layout:"vertical",onFinish:t=>{var e;M.validateFields();const a={...t,category_id:t.category_id.value,images:K.map((t=>t.name)),shop_id:t.shop_id.value,active_time:t.active_time.toString(),total_time:t.total_time.toString(),nutrition:t.nutrition.map((t=>({...t,percentage:String(t.percentage),weight:String(t.weight)}))),stocks:null===(e=t.stocks)||void 0===e?void 0:e.map((t=>({min_quantity:t.min_quantity,stock_id:t.stock_id.value})))};z(!0);const i="catalog/recept";m.A.update(y,a).then((()=>{n.oR.success(b("successfully.updated")),V("/".concat(i)),j((0,g.EK)({...k,nextUrl:i}))})).finally((()=>z(!1)))},form:M,initialValues:{active:!0,...k.data},children:[(0,f.jsx)(s.A,{current:S,children:h.C.map((t=>(0,f.jsx)(_,{title:b(t.title)},t.title)))}),h.C.map((t=>{const e=t.content;return(0,f.jsx)("div",{className:"steps-content ".concat(t.step!==S+1&&"hidden"),children:(0,f.jsx)(e,{next:O,prev:B,loading:L,image:F,setImage:N,back:C,setBack:E})},t.title)}))]})})}}}]);